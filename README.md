В комментах отметил узкие места